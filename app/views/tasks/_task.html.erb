  <!-- app/views/tasks/_task.html.erb -->
  <div id="<%= dom_id(task) %>">
    <div class="card mb-3">
      <div class="flex items-start justify-between gap-3">
        <div class="min-w-0">
          <h3 class="text-base font-semibold truncate">
            <%= link_to task.title,
                        task_path(task),
                        data: {turbo_frame: "task_modal" },
                        class: "hover:underline" %>
          </h3>
          <% if task.description.present? %>
            <p class="mt-1 text-sm text-gray-700 line-clamp-3"><%= task.description %></p>
          <% end %>

          <%# Badge classes %>
          <% status_class = case task.status
             when 'done' then 'badge-success'
             when 'doing' then 'badge-info'
             else 'badge-neutral'
           end %>
          <% prio_val = task.priority.to_i %>
          <% prio_class = if prio_val >= 8
              'badge-danger'
            elsif prio_val >= 5
              'badge-warning'
            else
              'badge-neutral'
            end %>
          <% due_class = 'badge-neutral' %>
          <% if task.due_date.present? %>
            <% if task.due_date < Time.current %>
              <% due_class = 'badge-danger' %>
            <% elsif task.due_date.to_date == Date.current %>
              <% due_class = 'badge-warning' %>
            <% else %>
              <% due_class = 'badge-neutral' %>
            <% end %>
          <% end %>

          <div class="mt-2 flex flex-wrap items-center gap-2 text-xs">
            <span class="badge <%= status_class %>">
              <span class="mr-1">Status:</span>
              <span class="capitalize"><%= task.status %></span>
            </span>
            <% if task.due_date.present? %>
              <span class="badge <%= due_class %>">
                <span class="mr-1">Due:</span>
                <%= l(task.due_date, format: :long) %>
              </span>
            <% end %>
            <span class="badge <%= prio_class %>">
              <span class="mr-1">Priority:</span>
              <%= task.priority %>
            </span>
          </div>
        </div>
        <div class="shrink-0 flex items-start gap-2">
          <%= link_to "Edit",
                      edit_task_path(task),
                      data: {turbo_frame: "task_modal" },
                      class: "btn" %>
          <%= link_to "Delete",
                      task_path(task),
                      data: {
                        turbo_method: :delete,
                        turbo_confirm: "Delete this task?",
                        turbo_frame: "_top"
                      },
                      class: "btn-danger" %>
        </div>
      </div>
    </div>
  </div>
